<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="作者：张华 发表于：2020-08-19版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 问题升级了500M宽带，但电脑用网线直线WDNR4300路由器用perf3 -s与perf -c 192.168.99.1 -t 3测试时只不到200M．所以在一台式机上安装了软路由，测试结果立马上到接近1000M了．但用了1000M的电力猫之后，速度又下降到120左右，">
<meta property="og:type" content="article">
<meta property="og:title" content="软路由">
<meta property="og:url" content="http://yoursite.com/2020/08/19/软路由/index.html">
<meta property="og:site_name" content="技术并艺术着">
<meta property="og:description" content="作者：张华 发表于：2020-08-19版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 问题升级了500M宽带，但电脑用网线直线WDNR4300路由器用perf3 -s与perf -c 192.168.99.1 -t 3测试时只不到200M．所以在一台式机上安装了软路由，测试结果立马上到接近1000M了．但用了1000M的电力猫之后，速度又下降到120左右，">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020082422402826.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3F1cWk5OQ==,size_16,color_FFFFFF,t_70#pic_center">
<meta property="og:updated_time" content="2020-08-30T06:26:06.307Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="软路由">
<meta name="twitter:description" content="作者：张华 发表于：2020-08-19版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 问题升级了500M宽带，但电脑用网线直线WDNR4300路由器用perf3 -s与perf -c 192.168.99.1 -t 3测试时只不到200M．所以在一台式机上安装了软路由，测试结果立马上到接近1000M了．但用了1000M的电力猫之后，速度又下降到120左右，">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/2020082422402826.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3F1cWk5OQ==,size_16,color_FFFFFF,t_70#pic_center">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/08/19/软路由/"/>





  <title>软路由 | 技术并艺术着</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">技术并艺术着</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">张华的技术博客 - blog.csdn.net/quqi99</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/19/软路由/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张华">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="技术并艺术着">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">软路由</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-19T23:24:29+08:00">
                2020-08-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>作者：张华 发表于：2020-08-19<br>版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明</strong></p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>升级了500M宽带，但电脑用网线直线WDNR4300路由器用perf3 -s与perf -c 192.168.99.1 -t 3测试时只不到200M．所以在一台式机上安装了软路由，测试结果立马上到接近1000M了．<br>但用了1000M的电力猫之后，速度又下降到120左右，改成有线连接之后，又马又上到1000M．<br>看来瓶颈在于WDNR4300与电力猫．</p>
<h2 id="安装软路由"><a href="#安装软路由" class="headerlink" title="安装软路由"></a>安装软路由</h2><p>台式机上有两个之前做SR-IOV实验用的千兆网卡 (Winyao WY576T PCI-E X4 双口服务器千兆网卡 82576 1000M), 及一个Intel集成网卡．</p>
<ul>
<li>enp6s0f0与enp6s0f1通过passthough映射到KVM虚机. 注意不要使用macvtap+bridge模式，因为这样会造成无法从局域网ping macvtap设备上的IP，当在插一根网线到Intel集成网卡上后，默认路由总是在enp6s0f0上，从而导致无法访问台式机．enp6s0f0映射到openwrt虚机里是eth1用于生成br-lan, enp6s0f1映射到openwrt虚机里是eth0.</li>
<li>直接KVM安装导入OpenWRT x86镜像即可 (github直接下载)</li>
</ul>
<h2 id="网络拓扑"><a href="#网络拓扑" class="headerlink" title="网络拓扑"></a>网络拓扑</h2><p>目前家中的网络拓扑是：</p>
<ul>
<li>光猫，打电话改了桥接</li>
<li>tplink千兆路由器(192.168.2.0/24)拨号, 下接一千兆交换机接NAS, TV, Camera等．</li>
<li>台式机的enp6s0f0接tplink，从软路由(192.168.98.0/24)出来后，enp6s0f1再接一千兆交换机．</li>
<li>WNDR4300仍然从tplink出(192.168.99.0/24)</li>
<li>千兆电力猫连接软路由至卧室（电力猫速度太差，需要改成有线）<h2 id="目前问题"><a href="#目前问题" class="headerlink" title="目前问题"></a>目前问题</h2></li>
<li>台式机停电再来电自动启动的问题，改了BIOS但还未测试</li>
<li>tplink上IPv6也要拨号但复用IPv4的拨号连接后是有IPv6地址的（光猫桥接并未挡住什么），客户端直接连接tplink也能拿到IPv6, 但tplink下挂的OpenWRT路由器却拿不到IPv6, 可能是OpenWrt镜像缺包吧，因为在WAN6那里找不到dhcpv6 client，只有dhcp client) ，原因见：　<a href="https://agong.me/2019/soft-router-compile-ipv6-mppddial-by-top-navigation.html" target="_blank" rel="external">https://agong.me/2019/soft-router-compile-ipv6-mppddial-by-top-navigation.html</a> (<strong>20200824更新,就是这个原因</strong>). 那现在另外一个路由器以dhcp接在这个拨号路由器后lan口又如何获取IPv6地址呢?</li>
<li>ubuntu在/etc/network/interfaces不定义时可以拿到IPv6，但要使用桥接如何定义也能拿到IPv6呢？</li>
<li>如何将无线网卡给KVM用，同时在openwrt虚机中用它做AP?</li>
</ul>
<h2 id="一级路由访问二级路由"><a href="#一级路由访问二级路由" class="headerlink" title="一级路由访问二级路由"></a>一级路由访问二级路由</h2><p>当在一级redmi ax5路由(192.168.2.1)下又接了一个二级openwrt路由(192.168.2.47, 192.168.99.1).<br>那一级路由下的node1(192.168.2.111)如何访问二级路由下的t440p (192.168.99.136)呢?<br>1, 先照着这处贴子将redmi ax5的ssh打开, 必须重启,之后就可以通过root/admin 来ssh了(不影响web管理密码), 然后使用’passwd root’来修改密码.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.2.1/cgi-bin/luci/;stok=5aa4576eb44e9e70dc1557c3e74b57a2/web/home#router</span><br><span class="line"></span><br><span class="line">http://192.168.2.1/cgi-bin/luci/;stok=5aa4576eb44e9e70dc1557c3e74b57a2/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h;nvram set ssh%5Fen%3D1; nvram commit;</span><br><span class="line"></span><br><span class="line">http://192.168.2.1/cgi-bin/luci/;stok=5aa4576eb44e9e70dc1557c3e74b57a2/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h%3B%20nvram%20set%20ssh_en%3D1%3B%20nvram%20commit%3B%20sed%20-i%20&apos;s%2Fchannel%3D.*%2Fchannel%3D%5C%22debug%5C%22%2Fg&apos;%20%2Fetc%2Finit.d%2Fdropbear%3B%20%2Fetc%2Finit.d%2Fdropbear%20start%3B</span><br><span class="line"></span><br><span class="line">http://192.168.2.1/cgi-bin/luci/;stok=5aa4576eb44e9e70dc1557c3e74b57a2/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h%3B%20echo%20-e%20&apos;admin%5Cnadmin&apos;%20%7C%20passwd%20root%3B</span><br></pre></td></tr></table></figure></p>
<p>2, 在二级路由器上如下图关闭防火墙,<br><img src="https://img-blog.csdnimg.cn/2020082422402826.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3F1cWk5OQ==,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"><br>3, 在一级路由下添加静态路由<br>route add -net 192.168.99.0 netmask 255.255.255.0 gw 192.168.2.47</p>
<p>4, 在二级路由上将192.168.2.47作静态IP绑定(MAC/IP绑定即可)</p>
<p>5, 如果不行,似乎在一级路由器上上图中lan处防火墙设置中的forwarding不能是REJECT哦.</p>
<h2 id="DDNS"><a href="#DDNS" class="headerlink" title="DDNS"></a>DDNS</h2><p>miwifi上集成的DDNS服务基本上都是收费的, 花生壳的二级域名壳域名不收费, 但这家公司喜欢删域名, 要求你实名制, 但实名制前又问你最喜欢的动物是什么, 答错了还弄不成实名制, 打电话给客服了, 让你把身份证扫描件发到800@oray.com人工审核, 但也没下文了, 等得头疼. 另外, 就是太喜欢删域名了, 申请的壳域名忽然就删了, 被删了也不知道的怎么被删的, 死得不明不白. 得了, 还是整个免费的吧. 申请一个dnsexit的二级域名, 然后用下列脚本更新.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">bash -c &apos;cat &gt; /data/ddns&apos; &lt;&lt; EOF</span><br><span class="line">#!/bin/sh</span><br><span class="line">myip=$(curl -s http://myip.dnsomatic.com/)</span><br><span class="line">if [ -e &quot;ip.txt&quot; ]</span><br><span class="line">then</span><br><span class="line">  old_ip=$(cat ip.txt)</span><br><span class="line">  if [ &quot;$myip&quot; == &quot;$old_ip&quot; ]</span><br><span class="line">  then</span><br><span class="line">    echo &quot;Your IP $myip didn&apos;t change.&quot;</span><br><span class="line">  else</span><br><span class="line">    echo &quot;$myip&quot; &gt; ip.txt</span><br><span class="line">    echo &quot;The IP Changed from $old_ip to $myip&quot;</span><br><span class="line">    change_dot_com=$(curl -s &quot;http://update.dnsexit.com/RemoteUpdate.sv?login=&lt;user&gt;&amp;password=&lt;password&gt;&amp;host=&lt;domain&gt;&amp;myip=$&#123;myip&#125;&quot;)</span><br><span class="line">    echo &quot;$change_dot_com&quot;</span><br><span class="line">    sleep 2</span><br><span class="line">  fi</span><br><span class="line">  else</span><br><span class="line">    echo &quot;$myip&quot; &gt; ip.txt</span><br><span class="line">    echo &quot;Your IP is $myip&quot;</span><br><span class="line">fi</span><br><span class="line">EOF</span><br><span class="line">chmod +x /data/ddns</span><br><span class="line">crontab -e</span><br><span class="line">*/60 * * * * /data/ddns &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">nslookup -vc quqi99.publicvm.com 8.8.8.8</span><br></pre></td></tr></table></figure>
<h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><p>1, 默认REJET</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">config defaults</span><br><span class="line">        option syn_flood &apos;0&apos;</span><br><span class="line">        option input &apos;REJECT&apos;</span><br><span class="line">        option output &apos;ACCEPT&apos;</span><br><span class="line">        option forward &apos;REJECT&apos;</span><br><span class="line">        option drop_invalid &apos;1&apos;</span><br><span class="line">        option disable_ipv6 &apos;0&apos;</span><br><span class="line">config zone</span><br><span class="line">        option name &apos;lan&apos;</span><br><span class="line">        option network &apos;lan&apos;</span><br><span class="line">        option input &apos;ACCEPT&apos;</span><br><span class="line">        option output &apos;ACCEPT&apos;</span><br><span class="line">        option forward &apos;ACCEPT&apos;</span><br><span class="line">config zone</span><br><span class="line">        option name &apos;wan&apos;</span><br><span class="line">        list network &apos;wan&apos;</span><br><span class="line">        list network &apos;wan6&apos;</span><br><span class="line">        option input &apos;REJECT&apos;</span><br><span class="line">        option output &apos;ACCEPT&apos;</span><br><span class="line">        option forward &apos;REJECT&apos;</span><br><span class="line">        option masq &apos;1&apos;</span><br><span class="line">        option mtu_fix &apos;1&apos;</span><br></pre></td></tr></table></figure>
<p>2, 打开22端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config rule &apos;ssh&apos;</span><br><span class="line">        option name &apos;ssh&apos;</span><br><span class="line">        option src &apos;wan&apos;</span><br><span class="line">        option dest_port &apos;22&apos;</span><br><span class="line">        option proto &apos;tcp&apos;</span><br><span class="line">        option target &apos;ACCEPT&apos;</span><br><span class="line">        option family &apos;ipv4&apos;</span><br></pre></td></tr></table></figure></p>
<p>3, 转发2222端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">config redirect &apos;wan2222rdr1&apos;</span><br><span class="line">        option proto &apos;tcp&apos;</span><br><span class="line">        option src_dport &apos;2222&apos;</span><br><span class="line">        option dest_ip &apos;192.168.2.47&apos;</span><br><span class="line">        option dest_port &apos;22&apos;</span><br><span class="line">        option src &apos;wan&apos;</span><br><span class="line">        option name &apos;x86_openwrt&apos;</span><br><span class="line">        option target &apos;DNAT&apos;</span><br><span class="line">        option ftype &apos;1&apos;</span><br><span class="line">        option dest &apos;lan&apos;</span><br><span class="line">root@XiaoQiang:~# iptables-save |grep 47</span><br><span class="line">-A zone_lan_postrouting -s 192.168.2.0/24 -d 192.168.2.47/32 -p tcp -m tcp --dport 22 -m comment --comment &quot;!fw3: x86_openwrt (reflection)&quot; -j SNAT --to-source 192.168.2.1</span><br><span class="line">-A zone_lan_prerouting -s 192.168.2.0/24 -d 123.115.196.xxx/32 -p tcp -m tcp --dport 2222 -m comment --comment &quot;!fw3: x86_openwrt (reflection)&quot; -j DNAT --to-destination 192.168.2.47:22</span><br><span class="line">-A zone_wan_prerouting -p tcp -m tcp --dport 2222 -m comment --comment &quot;!fw3: x86_openwrt&quot; -j DNAT --to-destination 192.168.2.47:22</span><br></pre></td></tr></table></figure>
<p>转发端口时不需要为2222单独定义input规则, 另外, 联通除了封80, 443, 以外其实没有封其它端口, 可用<a href="https://tool.chinaz.com/port/" target="_blank" rel="external">https://tool.chinaz.com/port/</a> 检测 (检测时得做redirect规则, 且开服务)</p>
<h2 id="https网站不好使"><a href="#https网站不好使" class="headerlink" title="https网站不好使"></a>https网站不好使</h2><p>像csdn与baidu等网站出现HSTS相关的证书错误, 是因为广告过滤大师使用了KoolProxy签发的证书所致, 所以需要关闭广告过滤大师.</p>
<h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/docker/daemon.json</span><br><span class="line">&quot;data-root&quot;: &quot;/mnt/udisk/docker&quot;,</span><br><span class="line">/etc/init.d/dockerd restart</span><br><span class="line"></span><br><span class="line">#install a better docker frontend - https://koolshare.cn/thread-180474-1-1.html</span><br><span class="line">docker pull portainer/portainer</span><br><span class="line">#create a continer with portainer image, expose port 9000:9000/tcp and bind mount &apos;/var/run/docker.sock:/var/run/docker.sock&apos;</span><br><span class="line">http://192.168.99.1:9000/#/init/admin</span><br><span class="line">http://192.168.99.1:9000/#/dashboard</span><br><span class="line"></span><br><span class="line">#intall docker search ubuntu</span><br><span class="line">docker pull ubuntu</span><br><span class="line">docker run -it ubuntu</span><br><span class="line">docker ps -a</span><br></pre></td></tr></table></figure>
<h2 id="天翼云盘"><a href="#天翼云盘" class="headerlink" title="天翼云盘"></a>天翼云盘</h2><p>天翼云盘是一个独立的家庭云空间，不等同于天翼云，无法获取S3登陆参数，也关闭了API - <a href="https://zhuanlan.zhihu.com/p/38592985" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/38592985</a><br>所以它无法使用s3fs加载块设备，但使用s3fs的方法类似于：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install build-essential libfuse-dev libcurl4-openssl-dev libxml2-dev mime-support automake libtool s3fs</span><br><span class="line">echo xxx:xxx |sudo tee /etc/passwd-s3fs &amp;&amp; sudo chmod 600 /etc/passwd-s3fs &amp;&amp; sudo chown $USER /etc/passwd-s3fs</span><br><span class="line">sudo mkdir /mnt/tianyi &amp;&amp; sudo chown $USER /mnt/tianyi</span><br><span class="line">s3fs -o passwd_file=/etc/passwd-s3fs -o url=http://oos.ctyunapi.cn bucket-dingjia /mnt/tianyi</span><br><span class="line">df -h</span><br><span class="line">fusermount -u /mnt/tianyi</span><br></pre></td></tr></table></figure>
<p>它可以使用sharelist，但用途不大．<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#sudo apt install nodejs npm -y  &amp;&amp; sudo npm install -g npm</span><br><span class="line">git clone https://github.com/reruin/sharelist.git</span><br><span class="line">cd sharelist &amp;&amp; sudo chmod +x ./install.sh &amp;&amp; sudo ./install.sh  #http://127.0.0.1:33001/</span><br><span class="line">#cd ./sharelist/ &amp;&amp; node app.js                                  #http://127.0.0.1:33001/</span><br></pre></td></tr></table></figure></p>
<h2 id="BaiduPCS-Web"><a href="#BaiduPCS-Web" class="headerlink" title="BaiduPCS-Web"></a>BaiduPCS-Web</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># server side</span><br><span class="line"># nfs GUI(http://192.168.99.1/cgi-bin/luci/admin/nas/nfs)是坏的(luci-app-nfs - https://github.com/coolsnowwolf/lede/issues/2957)，只能使用CLI</span><br><span class="line">echo &apos;/mnt/sdb1/nfs *(rw,sync,no_root_squash,subtree_check)&apos; &gt;&gt; /etc/exports</span><br><span class="line">/etc/init.d/nfsd restart</span><br><span class="line"></span><br><span class="line"># client side</span><br><span class="line">showmount -e 192.168.99.1</span><br><span class="line">sudo mount -t nfs 192.168.99.1:/mnt/sdb1/nfs /openwrt</span><br><span class="line">sudo fuser -m -v /openwrt/</span><br><span class="line">$ cat /etc/auto.direct |tail -n1</span><br><span class="line">/openwrt    -fstype=nfs4,rsize=32768,wsize=32768     192.168.99.1:/mnt/sdb1/nfs</span><br></pre></td></tr></table></figure>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] <a href="https://hansendong.me/609/" target="_blank" rel="external">https://hansendong.me/609/</a><br>[2] <a href="https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=4040453" target="_blank" rel="external">https://www.right.com.cn/forum/forum.php?mod=viewthread&amp;tid=4040453</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/07/09/Play-with-MAAS/" rel="next" title="Play with MAAS">
                <i class="fa fa-chevron-left"></i> Play with MAAS
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/09/10/如何让novnc-websockify支持tls1-2/" rel="prev" title="如何让novnc/websockify支持tls1.2">
                如何让novnc/websockify支持tls1.2 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Übersicht
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">张华</p>
              <p class="site-description motion-element" itemprop="description">blog.csdn.net/quqi99</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">77</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#问题"><span class="nav-number">1.</span> <span class="nav-text">问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装软路由"><span class="nav-number">2.</span> <span class="nav-text">安装软路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#网络拓扑"><span class="nav-number">3.</span> <span class="nav-text">网络拓扑</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#目前问题"><span class="nav-number">4.</span> <span class="nav-text">目前问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一级路由访问二级路由"><span class="nav-number">5.</span> <span class="nav-text">一级路由访问二级路由</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DDNS"><span class="nav-number">6.</span> <span class="nav-text">DDNS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#防火墙"><span class="nav-number">7.</span> <span class="nav-text">防火墙</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#https网站不好使"><span class="nav-number">8.</span> <span class="nav-text">https网站不好使</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#docker"><span class="nav-number">9.</span> <span class="nav-text">docker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#天翼云盘"><span class="nav-number">10.</span> <span class="nav-text">天翼云盘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BaiduPCS-Web"><span class="nav-number">11.</span> <span class="nav-text">BaiduPCS-Web</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">12.</span> <span class="nav-text">Reference</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张华</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
