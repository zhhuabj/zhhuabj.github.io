<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Play with LDAP + Keystone (by quqi99) | 技术并艺术着</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 (作者：张华 发表于：2018-05-29) Install OpenLDAP1234567891011121314151617export DEBIAN_FRONTEND=noninteractiveecho -e &amp;quot; \slapd slapd/internal/generated_adminpw">
<meta property="og:type" content="article">
<meta property="og:title" content="Play with LDAP + Keystone (by quqi99)">
<meta property="og:url" content="http://yoursite.com/2018/06/08/Play-with-LDAP-Keystone-by-quqi99/index.html">
<meta property="og:site_name" content="技术并艺术着">
<meta property="og:description" content="版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 (作者：张华 发表于：2018-05-29) Install OpenLDAP1234567891011121314151617export DEBIAN_FRONTEND=noninteractiveecho -e &amp;quot; \slapd slapd/internal/generated_adminpw">
<meta property="og:updated_time" content="2018-06-08T12:28:44.545Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Play with LDAP + Keystone (by quqi99)">
<meta name="twitter:description" content="版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 (作者：张华 发表于：2018-05-29) Install OpenLDAP1234567891011121314151617export DEBIAN_FRONTEND=noninteractiveecho -e &amp;quot; \slapd slapd/internal/generated_adminpw">
  
    <link rel="alternate" href="/atom.xml" title="技术并艺术着" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">技术并艺术着</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">张华的技术博客 - blog.csdn.net/quqi99</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Play-with-LDAP-Keystone-by-quqi99" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/08/Play-with-LDAP-Keystone-by-quqi99/" class="article-date">
  <time datetime="2018-06-08T10:09:28.000Z" itemprop="datePublished">2018-06-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Play with LDAP + Keystone (by quqi99)
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>版权声明：可以任意转载，转载时请务必以超链接形式标明文章原始出处和作者信息及本版权声明 (作者：张华 发表于：2018-05-29)</strong></p>
<h2 id="Install-OpenLDAP"><a href="#Install-OpenLDAP" class="headerlink" title="Install OpenLDAP"></a>Install OpenLDAP</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">export DEBIAN_FRONTEND=noninteractive</span><br><span class="line">echo -e &quot; \</span><br><span class="line">slapd slapd/internal/generated_adminpw password password</span><br><span class="line">slapd slapd/password2 password password</span><br><span class="line">slapd slapd/internal/adminpw password password</span><br><span class="line">slapd slapd/password1 password password</span><br><span class="line">&quot; | sudo debconf-set-selections</span><br><span class="line">sudo apt install slapd ldap-utils</span><br><span class="line">sudo service slapd restart</span><br><span class="line">#sudo dpkg-reconfigure slapd  #configure domain=cloud.sts, organization=cloud.sts, pass=password</span><br><span class="line">#slappasswd -h &#123;SSHA&#125; -s password</span><br><span class="line"></span><br><span class="line">ubuntu@juju-332891-mitaka-ceph-5:~$ ldapsearch -x -LLL -Hldap:/// -b dc=cloud,dc=sts dn</span><br><span class="line">dn: dc=cloud,dc=sts</span><br><span class="line">dn: cn=admin,dc=cloud,dc=sts</span><br><span class="line"></span><br><span class="line">sudo apt-get install jxplorer  #GUI</span><br></pre></td></tr></table></figure>
<h2 id="Modify-default-schema-to-support-OpenStack"><a href="#Modify-default-schema-to-support-OpenStack" class="headerlink" title="Modify default schema to support OpenStack"></a>Modify default schema to support OpenStack</h2><p><a href="https://wiki.openstack.org/wiki/OpenLDAP" target="_blank" rel="external">https://wiki.openstack.org/wiki/OpenLDAP</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">sudo ldapsearch -h 10.5.0.53 -x -w password -D&quot;cn=admin,dc=cloud,dc=sts&quot; -b dc=cloud,dc=sts &#125;&#125;</span><br><span class="line">sudo ldapsearch -h 10.5.0.53 -x -b &apos;dc=cloud,dc=sts&apos; &apos;(objectclass=*)&apos;</span><br><span class="line">#sudo ldapdelete -x -v -w password -D &quot;cn=admin,dc=cloud,dc=sts&quot; &quot;ou=Groups,dc=cloud,dc=sts&quot;</span><br><span class="line">#sudo ldapdelete -x -v -w password -D &quot;cn=admin,dc=cloud,dc=sts&quot; &quot;ou=Users,dc=cloud,dc=sts&quot;</span><br><span class="line">#sudo ldapdelete -x -v -w password -D &quot;cn=admin,dc=cloud,dc=sts&quot; &quot;ou=Roles,dc=cloud,dc=sts&quot;</span><br><span class="line"></span><br><span class="line">The standard LDAP objectClass inetOrgPerson which is defined in /etc/ldap/schema/inetorgperson.ldif, Currently, only two fields are used: cn and sn. cn is used for the bind call, and is the id field in the user object.</span><br><span class="line">Tenants are instancs of the groupOfNames object class defined in /etc/ldap/schema/core.ldif. Tenant membership is indicated by the presence of the User’s DN in the tenant’s members attribute.</span><br><span class="line">Roles are instances of the LDAP object class organizationalRole defined in /etc/ldap/schema/core.ldif. Role assignment is indicated by the presence of the User’s DN in the roleOccupant attribute.</span><br><span class="line"></span><br><span class="line">ubuntu@juju-332891-mitaka-ceph-5:~$ sudo ldapadd -x -w password -D&quot;cn=admin,dc=cloud,dc=sts&quot; -f /tmp/openstack.ldif</span><br><span class="line">ubuntu@juju-332891-mitaka-ceph-5:~$ cat /tmp/openstack.ldif</span><br><span class="line">dn: ou=Cloud,dc=cloud,dc=sts</span><br><span class="line">dc: cloud</span><br><span class="line">objectClass: dcObject</span><br><span class="line">objectClass: organizationalUnit</span><br><span class="line">ou: Cloud</span><br><span class="line"></span><br><span class="line">dn: ou=Users,dc=cloud,dc=sts</span><br><span class="line">objectClass: organizationalUnit</span><br><span class="line">ou: Users</span><br><span class="line"></span><br><span class="line">dn: ou=Groups,dc=cloud,dc=sts</span><br><span class="line">objectClass: organizationalUnit</span><br><span class="line">ou: Groups</span><br><span class="line"></span><br><span class="line">dn: ou=Roles,dc=cloud,dc=sts</span><br><span class="line">objectClass: organizationalUnit</span><br><span class="line">ou: Roles</span><br><span class="line"></span><br><span class="line">dn: cn=tester,ou=Groups,dc=cloud,dc=sts</span><br><span class="line">objectClass: posixGroup</span><br><span class="line">cn: tester</span><br><span class="line">gidNumber: 5002</span><br><span class="line"></span><br><span class="line">dn: uid=quqi,ou=Users,dc=cloud,dc=sts</span><br><span class="line">objectClass: inetOrgPerson</span><br><span class="line">objectClass: posixAccount</span><br><span class="line">objectClass: shadowAccount</span><br><span class="line">uid: quqi</span><br><span class="line">sn: Joshua</span><br><span class="line">givenName: quqi</span><br><span class="line">cn: Joshua</span><br><span class="line">displayName: Joshua</span><br><span class="line">uidNumber: 10002</span><br><span class="line">gidNumber: 5002</span><br><span class="line">userPassword: password</span><br><span class="line">gecos: Joshua</span><br><span class="line">loginShell: /bin/bash</span><br><span class="line">homeDirectory: /home/quqi</span><br></pre></td></tr></table></figure>
<h2 id="Configure-Keystone"><a href="#Configure-Keystone" class="headerlink" title="Configure Keystone"></a>Configure Keystone</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">juju config keystone preferred-api-version=3</span><br><span class="line">juju deploy keystone-ldap --series xenial</span><br><span class="line">juju add-relation keystone-ldap keystone</span><br><span class="line"></span><br><span class="line">juju config keystone-ldap ldap-server=&quot;ldap://10.5.0.53/&quot; ldap-user=&quot;cn=admin,dc=cloud,dc=sts&quot; ldap-password=&quot;password&quot; ldap-suffix=&quot;dc=cloud,dc=sts&quot;</span><br><span class="line">juju config keystone-ldap domain-name=&quot;cloud.sts&quot;</span><br><span class="line">#juju config keystone-ldap --file /tmp/flags-config.yaml</span><br><span class="line">cat /tmp/flags-config.yaml</span><br><span class="line">keystone-ldap:</span><br><span class="line">  ldap-config-flags: &quot;&#123;</span><br><span class="line">    url = ldap://10.5.0.53</span><br><span class="line">    user = cn=admin,dc=cloud,dc=sts</span><br><span class="line">    password = password</span><br><span class="line">    suffix = cn=cloud,cn=sts</span><br><span class="line">    user_tree_dn = ou=Users,dc=cloud,dc=sts</span><br><span class="line">    user_objectclass = inetOrgPerson</span><br><span class="line">    group_tree_dn = ou=Groups,dc=cloud,dc=sts</span><br><span class="line">    # The LDAP object class to use for groups. If setting this option to</span><br><span class="line">    # `posixGroup`, you may also be interested in enabling the `[ldap]</span><br><span class="line">    # group_members_are_ids` option. (string value)</span><br><span class="line">    group_objectclass = posixGroup</span><br><span class="line">    # Enable this option if the members of the group object class are keystone user</span><br><span class="line">    # IDs rather than LDAP DNs. This is the case when using `posixGroup` as the</span><br><span class="line">    # group object class in Open Directory. (boolean value)</span><br><span class="line">    group_members_are_ids = false</span><br><span class="line">    user_id_attribute = uidNumber</span><br><span class="line">    user_name_attribute = uid</span><br><span class="line">    group_id_attribute = gidNumber</span><br><span class="line">    group_name_attribute = cn</span><br><span class="line">    user_enabled_emulation = False</span><br><span class="line">    user_enabled_emulation_dn = &apos;cn=openstack,ou=groups,dc=cloud,dc=sts&apos;</span><br><span class="line">&#125;&quot;</span><br><span class="line">juju config keystone-ldap ldap-config-flags=&quot;&#123;url: &apos;ldap://10.5.0.53&apos;, user: &apos;cn=admin,dc=cloud,dc=sts&apos;, password: &apos;password&apos;, suffix: &apos;cn=cloud,cn=sts&apos;, user_tree_dn: &apos;ou=Users,dc=cloud,dc=sts&apos;, user_objectclass: &apos;inetOrgPerson&apos;, group_tree_dn: &apos;ou=Groups,dc=cloud,dc=sts&apos;, group_objectclass: &apos;posixGroup&apos;, group_members_are_ids: true, user_id_attribute: uidNumber, user_name_attribute: uid, group_id_attribute: gidNumber, group_name_attribute: cn, user_enabled_emulation: False, user_enabled_emulation_dn: &apos;cn=openstack,ou=groups,dc=cloud,dc=sts&#125;&quot;</span><br><span class="line">ls /etc/keystone/domains/keystone.cloud.sts.conf</span><br><span class="line">sudo service apache2 restart  # then restart keystone server</span><br></pre></td></tr></table></figure>
<p>上面的配置不work, 下面的可以：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">root@juju-332891-mitaka-ceph-5:~# cat /etc/keystone/domains/keystone.cloud.sts.conf</span><br><span class="line">[ldap]</span><br><span class="line">url = ldap://10.5.0.53/</span><br><span class="line">user = cn=admin,dc=cloud,dc=sts</span><br><span class="line">password = password</span><br><span class="line">suffix = dc=cloud,dc=sts</span><br><span class="line"></span><br><span class="line">user_allow_create = False</span><br><span class="line">user_allow_update = False</span><br><span class="line">user_allow_delete = False</span><br><span class="line"></span><br><span class="line">group_allow_create = False</span><br><span class="line">group_allow_update = False</span><br><span class="line">group_allow_delete = False</span><br><span class="line"></span><br><span class="line"># User supplied configuration flags</span><br><span class="line">group_members_are_ids = False</span><br><span class="line">group_objectclass = groupOfNames</span><br><span class="line">group_tree_dn = ou=Groups,dc=cloud,dc=sts</span><br><span class="line">password = password</span><br><span class="line">suffix = cn=cloud,cn=sts</span><br><span class="line">url = ldap://10.5.0.53</span><br><span class="line">user = cn=admin,dc=cloud,dc=sts</span><br><span class="line">user_objectclass = inetOrgPerson</span><br><span class="line">#user_tree_dn = ou=Users,dc=cloud,dc=sts</span><br><span class="line">user_tree_dn = dc=cloud,dc=sts</span><br><span class="line"></span><br><span class="line">query_scope = sub</span><br><span class="line">user_id_attribute = uidNumber</span><br><span class="line">user_name_attribute = uid</span><br><span class="line">group_id_attribute = gidNumber</span><br><span class="line">#group_name_attribute = cn</span><br><span class="line">#group_member_attribute = memberUid</span><br><span class="line"></span><br><span class="line">[identity]</span><br><span class="line">driver = ldap</span><br></pre></td></tr></table></figure></p>
<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">export OS_REGION_NAME=RegionOne</span><br><span class="line">export OS_USER_DOMAIN_NAME=admin_domain</span><br><span class="line">export OS_AUTH_VERSION=3</span><br><span class="line">export OS_IDENTITY_API_VERSION=3</span><br><span class="line">export OS_PASSWORD=openstack</span><br><span class="line">export OS_DOMAIN_NAME=admin_domain</span><br><span class="line">export OS_AUTH_URL=http://10.5.0.53:5000/v3</span><br><span class="line">export OS_USERNAME=admin</span><br><span class="line"></span><br><span class="line">openstack domain create --description &quot;cloud.sts&quot; cloud.sts</span><br><span class="line">openstack domain list</span><br><span class="line"></span><br><span class="line">export OS_USER_DOMAIN_NAME=cloud.sts</span><br><span class="line">export OS_DOMAIN_NAME=cloud.sts</span><br><span class="line">export OS_USERNAME=admin</span><br><span class="line">export OS_PASSWORD=password</span><br><span class="line"></span><br><span class="line">sudo ldapsearch -h 10.5.0.53 -x -b &apos;dc=cloud,dc=sts&apos; &apos;(objectclass=*)&apos;</span><br><span class="line"># quqi, Users, cloud.sts</span><br><span class="line">dn: uid=quqi,ou=Users,dc=cloud,dc=sts</span><br><span class="line">objectClass: inetOrgPerson</span><br><span class="line">objectClass: posixAccount</span><br><span class="line">objectClass: shadowAccount</span><br><span class="line">uid: quqi</span><br><span class="line">sn: Joshua</span><br><span class="line">givenName: quqi</span><br><span class="line">cn: Joshua</span><br><span class="line">displayName: Joshua</span><br><span class="line">uidNumber: 10002</span><br><span class="line">gidNumber: 5002</span><br><span class="line">gecos: Joshua</span><br><span class="line">loginShell: /bin/bash</span><br><span class="line">homeDirectory: /home/quqi</span><br><span class="line"></span><br><span class="line">openstack domain create --description &quot;cloud.sts&quot; cloud.sts</span><br><span class="line">openstack domain list</span><br><span class="line">openstack project list</span><br><span class="line">openstack project create procloud --domain cloud.sts</span><br><span class="line">openstack role create ladmin</span><br><span class="line">openstack role add --project procloud --user quqi ladmin  #the user quqi comes from LDAP</span><br><span class="line"></span><br><span class="line">$ openstack user show quqi --domain cloud.sts</span><br><span class="line">+-----------+------------------------------------------------------------------+</span><br><span class="line">| Field     | Value                                                            |</span><br><span class="line">+-----------+------------------------------------------------------------------+</span><br><span class="line">| domain_id | 4061a7b292c54a5eaf57cd1a0b9afcc2                                 |</span><br><span class="line">| id        | 67c688b4fb0782595cb5850258f1bfeb40d4b5f0df749760b68c1d0fcbfaeb3a |</span><br><span class="line">| name      | quqi                                                             |</span><br><span class="line">+-----------+------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>找不着用户quqi时, 可查看日志：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(keystone.common.ldap.core): 2018-06-08 12:13:23,145 DEBUG LDAP bind: who=cn=admin,dc=cloud,dc=sts</span><br><span class="line">(keystone.common.ldap.core): 2018-06-08 12:13:23,145 DEBUG LDAP search: base=dc=cloud,dc=sts scope=2 filterstr=(&amp;(uidNumber=10002)(objectClass=inetOrgPerson)) attrs=[&apos;description&apos;, &apos;uidNumber&apos;, &apos;userPassword&apos;, &apos;enabled&apos;, &apos;mail&apos;, &apos;uid&apos;] attrsonly=0</span><br></pre></td></tr></table></figure></p>
<p>转换成下列命令看是否能运行:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ldapsearch -h 10.5.0.53 -x -b &apos;dc=cloud,dc=sts&apos; -s sub &quot;(&amp;(uidNumber=10002)(objectClass=inetOrgPerson))&quot; description uidNumber userPassword enabled mail uid attrsonly=0</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/06/08/Play-with-LDAP-Keystone-by-quqi99/" data-id="cji5y69bj000766bpaych78qk" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/03/15/回顾OpenStack中的测试/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">回顾OpenStack中的测试</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/06/08/Play-with-LDAP-Keystone-by-quqi99/">Play with LDAP + Keystone (by quqi99)</a>
          </li>
        
          <li>
            <a href="/2018/03/15/回顾OpenStack中的测试/">回顾OpenStack中的测试</a>
          </li>
        
          <li>
            <a href="/2018/03/09/Libvirt支持的三种CPU模式与热迁移-by-Joshua/">Libvirt支持的三种CPU模式与热迁移(by Joshua)</a>
          </li>
        
          <li>
            <a href="/2018/02/07/OpenStack-SSL/">OpenStack SSL</a>
          </li>
        
          <li>
            <a href="/2018/02/06/Set-up-juju-development-env/">Set up juju development env</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 张华<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>